@using UI.App.Components
@using UI.App.Services
@inject AppState State
@page "/"

<SimpleComponent Name=@State.Name MyEvent=@OnComponentEvent ref="_simpleComponent"></SimpleComponent>

<div>
    <button onclick=@SetViaMethod>Set name via component method</button>
    <button onclick=@SetViaState>Set name via app state property</button>
    <button onclick=@SetViaStateMethod>Set name via app state method</button>
    <button onclick=@(() => StateHasChanged())>Fire StateHasChanged()</button>
</div>

<ObjectComponent Data=@State.Data></ObjectComponent>

<div>
    <button onclick=@SetStateData>Set state data</button>
    <button onclick=@IncreaseAge>Increase age</button>
    <button onclick=@UpdateStateByServer>Update by API</button>
</div>

@functions {

    private SimpleComponent _simpleComponent;

    private void SetViaMethod()
    {
        _simpleComponent.SetName($"Changed by method {DateTime.Now}");
    }

    private void SetViaState()
    {
        State.Name = $"Changed by app state property {DateTime.Now}";
    }

    private void SetViaStateMethod()
    {
        State.SetName($"Changed by app state method {DateTime.Now}");
    }

    private void OnComponentEvent()
    {
        SetViaStateMethod();
    }

    private void SetStateData()
    {
        State.Data = new ObjectComponentModel { Age = 1, Name = $"Hi at {DateTime.Now}" };
    }

    private void IncreaseAge()
    {
        State.Data.Age++;
    }

    private async Task UpdateStateByServer()
    {
        await State.UpdateByApi();
    }
}